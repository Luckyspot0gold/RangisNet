<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RangisNet MVP - Predict â†’ Feel â†’ Pay</title>
    <meta name="description" content="The Venmo of Felt Economics - Multi-sensory AI trading on Avalanche">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-align: center;
        }

        .tagline {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .demo-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .step {
            margin-bottom: 30px;
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .step-number {
            background: #fff;
            color: #667eea;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .step-title {
            font-size: 1.4em;
            font-weight: 600;
        }

        button {
            width: 100%;
            padding: 15px 30px;
            font-size: 1.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 15px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }

        .result.visible {
            display: block;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .metric-value {
            font-weight: bold;
        }

        .confidence-high {
            color: #4ade80;
        }

        .confidence-medium {
            color: #fbbf24;
        }

        .confidence-low {
            color: #f87171;
        }

        /* ARIA live region for screen readers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .pulse-indicator {
            width: 100px;
            height: 100px;
            margin: 20px auto;
            border-radius: 50%;
            background: radial-gradient(circle, #fff, transparent);
            animation: pulse 2s ease-in-out infinite;
            opacity: 0;
        }

        .pulse-indicator.active {
            opacity: 1;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 1; }
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.9em;
            opacity: 0.8;
        }

        .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽµ RangisNet</h1>
        <p class="tagline">The Venmo of Felt Economics</p>

        <!-- ARIA live region for screen reader announcements -->
        <div aria-live="polite" aria-atomic="true" class="sr-only" id="aria-announcements"></div>

        <div class="demo-section">
            <!-- Step 1: Predict -->
            <div class="step">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Predict</div>
                </div>
                <button id="predictBtn" onclick="runPrediction()" aria-describedby="predict-description">
                    Analyze Market Conditions
                </button>
                <p id="predict-description" class="sr-only">
                    Click to analyze current market conditions using the Probability Tensor Engine. 
                    Results will include confidence level and sensory feedback.
                </p>
                <div id="predictResult" class="result" role="region" aria-label="Prediction results">
                    <div class="metric">
                        <span>Confidence:</span>
                        <span id="confidenceValue" class="metric-value">--</span>
                    </div>
                    <div class="metric">
                        <span>Frequency:</span>
                        <span id="frequencyValue" class="metric-value">--</span>
                    </div>
                    <div class="metric">
                        <span>Recommendation:</span>
                        <span id="recommendationValue" class="metric-value">--</span>
                    </div>
                </div>
            </div>

            <!-- Step 2: Feel -->
            <div class="step">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Feel</div>
                </div>
                <div class="pulse-indicator" id="pulseIndicator"></div>
                <button id="feelBtn" onclick="triggerFeedback()" disabled aria-describedby="feel-description">
                    Experience Sensory Feedback
                </button>
                <p id="feel-description" class="sr-only">
                    Activate haptic vibration and audio tone based on market confidence. 
                    High confidence produces smooth, long pulses. Low confidence produces sharp, short bursts.
                </p>
            </div>

            <!-- Step 3: Pay -->
            <div class="step">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Pay</div>
                </div>
                <button id="payBtn" onclick="connectWallet()" disabled aria-describedby="pay-description">
                    Connect Wallet & Pay
                </button>
                <p id="pay-description" class="sr-only">
                    Connect your MetaMask or compatible wallet to process USDC micropayment on Avalanche Fuji testnet.
                </p>
                <div id="payResult" class="result" role="status" aria-live="polite">
                    <div class="metric">
                        <span>Status:</span>
                        <span id="payStatus">Ready</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div>
                <span class="badge">ðŸŽ¯ 0.069Î¼s latency</span>
                <span class="badge">ðŸ”Š 432-1432 Hz</span>
                <span class="badge">ðŸ“³ Haptic</span>
            </div>
            <p style="margin-top: 15px;">
                <strong>Hack2Build: Payments x402</strong><br>
                Accessible for 2B+ non-visual users
            </p>
        </div>
    </div>

    <script>
        // Audio Context for harmonic tones
        let audioContext;
        let currentPrediction = null;

        // Initialize audio context on user interaction
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // Announce to screen readers
        function announce(message) {
            const ariaElement = document.getElementById('aria-announcements');
            ariaElement.textContent = message;
        }

        // Simple PTE Engine simulation
        function runPrediction() {
            initAudio();
            announce('Analyzing market conditions...');
            
            const predictBtn = document.getElementById('predictBtn');
            predictBtn.disabled = true;
            predictBtn.textContent = 'Analyzing...';

            // Simulate PTE computation (normally <1Î¼s)
            setTimeout(() => {
                // Mock data - in production, this comes from real PTE engine
                const rsi = 65 + Math.random() * 30;
                const vix = 15 + Math.random() * 10;
                
                // McCrea Equation: PRM = Ïƒ(Ï‰/5000) where Ï‰ = 2 Ã— RSI Ã— VIX
                const omega = 2 * rsi * vix;
                const prm = 1 / (1 + Math.exp(-omega / 5000));
                
                // Map to frequency (432-1432 Hz)
                const frequency = 432 + (prm * 1000);
                
                // Get recommendation
                let recommendation, confidenceClass;
                if (prm >= 0.7) {
                    recommendation = 'SEND';
                    confidenceClass = 'confidence-high';
                } else if (prm >= 0.3) {
                    recommendation = 'WAIT';
                    confidenceClass = 'confidence-medium';
                } else {
                    recommendation = 'REJECT';
                    confidenceClass = 'confidence-low';
                }

                currentPrediction = { prm, frequency, recommendation };

                // Display results
                document.getElementById('confidenceValue').textContent = 
                    (prm * 100).toFixed(1) + '%';
                document.getElementById('confidenceValue').className = 
                    'metric-value ' + confidenceClass;
                document.getElementById('frequencyValue').textContent = 
                    frequency.toFixed(0) + ' Hz';
                document.getElementById('recommendationValue').textContent = 
                    recommendation;
                
                document.getElementById('predictResult').classList.add('visible');
                
                // Enable feel button
                document.getElementById('feelBtn').disabled = false;
                
                predictBtn.textContent = 'Analyze Again';
                predictBtn.disabled = false;

                // Announce results
                announce(`Prediction complete. Confidence: ${(prm * 100).toFixed(1)}%. 
                         Frequency: ${frequency.toFixed(0)} Hz. 
                         Recommendation: ${recommendation}`);
            }, 500);
        }

        // Trigger sensory feedback (haptic + audio)
        function triggerFeedback() {
            if (!currentPrediction) return;

            initAudio();
            const { prm, frequency } = currentPrediction;

            announce('Activating sensory feedback...');

            // Show pulse indicator
            const pulseIndicator = document.getElementById('pulseIndicator');
            pulseIndicator.classList.add('active');

            // Haptic feedback via Vibration API
            if ('vibrate' in navigator) {
                const duration = prm > 0.7 ? 500 : prm > 0.3 ? 300 : 200;
                const intensity = Math.floor(prm * 100);
                navigator.vibrate([duration, 100, duration]);
                announce(`Haptic feedback activated. Pattern: ${prm > 0.7 ? 'smooth pulse' : prm > 0.3 ? 'gentle wave' : 'alert buzz'}`);
            } else {
                announce('Haptic feedback not supported on this device.');
            }

            // Audio feedback via Web Audio API
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = prm > 0.7 ? 'sine' : prm > 0.3 ? 'triangle' : 'square';
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 1);

            announce(`Audio tone playing at ${frequency.toFixed(0)} Hz`);

            // Enable pay button
            setTimeout(() => {
                document.getElementById('payBtn').disabled = false;
                pulseIndicator.classList.remove('active');
            }, 1500);
        }

        // Connect wallet (Thirdweb integration placeholder)
        async function connectWallet() {
            const payBtn = document.getElementById('payBtn');
            const payStatus = document.getElementById('payStatus');
            
            payBtn.disabled = true;
            payBtn.textContent = 'Connecting...';
            payStatus.textContent = 'Connecting wallet...';

            announce('Connecting to wallet...');

            // Check for Web3 provider
            if (typeof window.ethereum !== 'undefined') {
                try {
                    // Request account access
                    const accounts = await window.ethereum.request({ 
                        method: 'eth_requestAccounts' 
                    });
                    
                    payStatus.textContent = `Connected: ${accounts[0].substring(0, 6)}...${accounts[0].substring(38)}`;
                    payBtn.textContent = 'Process Payment';
                    
                    announce(`Wallet connected successfully. Address: ${accounts[0].substring(0, 6)}...${accounts[0].substring(38)}`);
                    
                    // In production, this would call the smart contract
                    payBtn.onclick = processPayment;
                    payBtn.disabled = false;
                    
                } catch (error) {
                    payStatus.textContent = 'Connection failed';
                    payBtn.textContent = 'Try Again';
                    payBtn.disabled = false;
                    announce('Wallet connection failed. Please try again.');
                }
            } else {
                payStatus.textContent = 'No wallet detected';
                payBtn.textContent = 'Install MetaMask';
                payBtn.onclick = () => window.open('https://metamask.io/download/', '_blank');
                payBtn.disabled = false;
                announce('No Web3 wallet detected. Please install MetaMask to continue.');
            }

            document.getElementById('payResult').classList.add('visible');
        }

        // Process payment (smart contract call placeholder)
        async function processPayment() {
            const payBtn = document.getElementById('payBtn');
            const payStatus = document.getElementById('payStatus');
            
            payBtn.disabled = true;
            payBtn.textContent = 'Processing...';
            payStatus.textContent = 'Confirming transaction...';

            announce('Processing USDC micropayment on Avalanche Fuji...');

            // Simulate transaction (in production, calls RangisPayment.sol)
            setTimeout(() => {
                payStatus.textContent = 'âœ… Payment confirmed!';
                payBtn.textContent = 'Payment Complete';
                
                announce('Payment successful! Transaction confirmed on Avalanche Fuji testnet.');
                
                // Celebration haptic
                if ('vibrate' in navigator) {
                    navigator.vibrate([200, 100, 200, 100, 200]);
                }
            }, 2000);
        }

        // Keyboard navigation support
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                const focused = document.activeElement;
                if (focused.tagName === 'BUTTON' && !focused.disabled) {
                    focused.click();
                    e.preventDefault();
                }
            }
        });
    </script>
</body>
</html>
